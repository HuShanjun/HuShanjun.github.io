# 游戏同步方式

## 一.基本概念

### **帧同步：**

​	 **概念**： 服务器将玩家的输入直接转发给其他玩家，自己不做处理。理论上所有客户端都以相同的初始状态开始，只要收到的输入相同，那么每时每刻的状态都是相同的。

​	**特点**： 

- 相同的输入 + 相同的时间 = 相同的显示
- 可以很方便的做出战斗回放：服务器记录所有操作， 客户端请求到操作文件再执行一次即可。
- 帧同步的特性导致客户端的逻辑实现和表现实现必须完全分离。Unity中的一些方法接口(如 Invoke， Update、动画系统等)是不可靠的，所有要自己实现一套物理引擎、数学库，做到逻辑和表现分离。 这样即使Unity的渲染是不同步的，但是逻辑跑出来是同步的。

​	也就是说，游戏接收来自网络的多个客户端的操作，如果这些操作在各个客户端上都是一样的，那么多个客户端的显示也就是一样的，进而带来了”同步“的效果。在这种情况下，各个客户端的运算要绝对一致，不能依赖诸如本地时间、本地随机等”输入“，而要一切以网络来的数据为主。

​	**一般步骤：**

- 同步随机数种子。(一般游戏中都设计随机数的使用， 通过同步随机数种子，可以保持随机数一致性)

- 客户端上传操作指令。(指令包括游戏操作和当前帧索引)


- 服务器广播所有客户端的操作。(如果没有操作， 也要广播空指令来驱动游戏帧前进)。


### **状态同步**： 

​	**概念**： 只同步影响游戏功能的某些重要的状态变量，并且这些重要的变量是在服务器运算出来的或者至少校验过的，客户端拿到这些状态变量后自行做本地表现。

一般来说帧同步在实时性、节省流量方面比较好，状态同步则在安全性角度来说更胜一筹。具体选用哪种方案由具体游戏类型来决定。



## 三. 参考文档

1. https://www.jianshu.com/p/8cca5458c45b
2. https://blog.csdn.net/David_Dai_1108/article/details/73437736
3. https://blog.csdn.net/weixin_43405546/article/details/92428696
4. https://blog.csdn.net/wangchuanjin/article/details/5487134

